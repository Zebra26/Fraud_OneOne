{
  "title": "System Health",
  "schemaVersion": 39,
  "panels": [
    {"type": "timeseries", "title": "CPU Usage (node)", "datasource": {"type": "prometheus", "uid": "Prometheus"},
     "targets": [{"expr": "100 - (avg by (instance) (rate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100)"}]},
    {"type": "timeseries", "title": "Memory Usage (node)", "datasource": {"type": "prometheus", "uid": "Prometheus"},
     "targets": [{"expr": "(1 - node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes) * 100"}]},
    {"type": "timeseries", "title": "Container CPU (cAdvisor)", "datasource": {"type": "prometheus", "uid": "Prometheus"},
     "targets": [{"expr": "sum by (container_label_com_docker_swarm_service_name) (rate(container_cpu_usage_seconds_total[5m]))"}]},
    {"type": "timeseries", "title": "Redis Evictions", "datasource": {"type": "prometheus", "uid": "Prometheus"},
     "targets": [{"expr": "increase(redis_evicted_keys_total[5m])"}]},
    {"type": "timeseries", "title": "Kafka Consumer Lag", "datasource": {"type": "prometheus", "uid": "Prometheus"},
     "targets": [{"expr": "max(consumer_group_lag)"}]}
    ,{"type":"timeseries","title":"Mongo Batch Flushes","datasource":{"type":"prometheus","uid":"Prometheus"},
      "targets":[{"expr":"rate(mongo_batch_flushes_total[5m])"}]},
     {"type":"timeseries","title":"Mongo Batch Items/s","datasource":{"type":"prometheus","uid":"Prometheus"},
      "targets":[{"expr":"rate(mongo_batch_items_total[5m])"}]},
     {"type":"timeseries","title":"Mongo Batch Queue Depth","datasource":{"type":"prometheus","uid":"Prometheus"},
      "targets":[{"expr":"mongo_batch_queue_depth"}]},
     {"type":"timeseries","title":"Kafka Produced msgs/s","datasource":{"type":"prometheus","uid":"Prometheus"},
      "targets":[{"expr":"rate(kafka_producer_messages_total[5m])"}]},
     {"type":"timeseries","title":"Redis Batch Flushes/s","datasource":{"type":"prometheus","uid":"Prometheus"},
      "targets":[{"expr":"rate(redis_batch_flushes_total[5m])"}]},
     {"type":"timeseries","title":"Redis Batch Items/s","datasource":{"type":"prometheus","uid":"Prometheus"},
      "targets":[{"expr":"rate(redis_batch_items_total[5m])"}]},
     {"type":"timeseries","title":"Redis Batch Queue Depth","datasource":{"type":"prometheus","uid":"Prometheus"},
      "targets":[{"expr":"redis_batch_queue_depth"}]},
     {"type":"timeseries","title":"CPU Utilization (%)","datasource":{"type":"prometheus","uid":"Prometheus"},
      "targets":[{"expr":"cpu_utilization_pct"}]},
     {"type":"timeseries","title":"Dropped Requests (5m rate)","datasource":{"type":"prometheus","uid":"Prometheus"},
      "targets":[{"expr":"rate(dropped_requests_total[5m])"}]}
  ]
}
