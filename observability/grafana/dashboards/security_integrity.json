{
  "title": "Security & Integrity",
  "schemaVersion": 39,
  "templating": {"list": [
    {"name":"service","type":"custom","query":"backend,ml-inference,trainer","options":[
      {"text":"backend","value":"backend","selected":true},
      {"text":"ml-inference","value":"ml-inference"},
      {"text":"trainer","value":"trainer"}
    ],"current":{"text":"backend","value":"backend"}}
  ]},
  "panels": [
    {"type": "timeseries", "title": "Auth Failures", "datasource": {"type": "prometheus", "uid": "Prometheus"},
     "fieldConfig": {"defaults": {"links": [
       {"title":"Explore Logs (Loki)",
        "url": "/explore?left=(datasource:\"Loki\",queries:!((expr:\"{job=\\\"fraud_k\\\", service=\\\"$service\\\", correlation_id=\\\"${__series.labels.correlation_id}\\\"}\")))",
        "targetBlank": true}
     ]},"overrides":[]},
     "targets": [{"expr": "increase(auth_failures_total[5m])"}, {"expr": "increase(jwt_failures_total[5m])"}]},
    {"type": "timeseries", "title": "HMAC Verifications", "datasource": {"type": "prometheus", "uid": "Prometheus"},
     "targets": [{"expr": "rate(hmac_verifications_total[5m])"}]},
    {"type": "timeseries", "title": "Model Integrity Failures", "datasource": {"type": "prometheus", "uid": "Prometheus"},
     "targets": [{"expr": "increase(model_integrity_failures_total[15m])"}, {"expr": "increase(model_signature_failures_total[15m])"}, {"expr": "increase(model_decrypt_failures_total[15m])"}]},
    {"type": "timeseries", "title": "Safe Mode State", "datasource": {"type": "prometheus", "uid": "Prometheus"},
     "targets": [{"expr": "safe_mode_state"}]}
  ]
}
